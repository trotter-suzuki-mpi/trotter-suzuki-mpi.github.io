<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Massively Parallel Trotter-Suzuki Solver: Mathematical Details</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="vortex.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Massively Parallel Trotter-Suzuki Solver
   &#160;<span id="projectnumber">1.6.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="md_download.html"><span>Download&#160;and&#160;Installation</span></a></li>
      <li><a href="md_tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="md_TSapproximation.html"><span>Mathematical&#160;Details</span></a></li>
      <li><a href="md_examples.html"><span>Examples</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="md_changes.html"><span>Revision&#160;History</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Mathematical Details </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>What follows is a brief description of the approximation used to calculate the evolution of the wave function. Formulas of the evolution operator are provided.</p>
<h1>Lattice </h1>
<p>The wave function is defined using the coordinate representation ( \(\psi(x,y) = \langle x,y|\psi\rangle\)). The coordinates parametrize a 'physical space'. These can be cartesian coordinates for 1D or 2D space, or cylindrical coordinates in 1D (only radial coordinate) or 2D (radial and axial coordinates). For computational reasons, the 'physical space' is finite, and each coordinate takes values on the intervals \(x \in [-L_x/2,L_x/2]\), \(y \in [-L_y/2,L_y/2]\) (cartesian coordinates) and \(r \in [0,L_r]\), \(z \in [-L_z/2,L_z/2]\) (cylindrical coordinates). The wave function is discretize in a lattice: for cartesian coordinates \(\psi(x,y)\) with \(x\) and \(y\) integer numbers: \(x = 0, 1, \ldots N_x-1\), \(y = 0, 1, \ldots N_y-1\), and similarly for the cylindrical coordinates: \(\psi(r,z)\) with \(r = 0, 1, \ldots N_r-1\), \(z = 0, 1, \ldots N_z-1\).</p>
<h1>MPI structure </h1>
<p>The evolution of the wave function can be distributed among independent processes, using the MPI framework. The lattice is divided in a number of smaller lattices, called tiles, equal to the number of available processes. Each process evolves the part of the wave function defined over the tile it has. In particular, each tile possesses points shared between neighbouring processes (cyan region) and points that are not shared (orange region). The former are needed to ensure stability of the evolution of the wave function inside the orange region. The integer numbers 'start-x', 'inner-start-x', ecc. define the size of the regions and they are calculated by the function 'calculate-borders'. Each point of the tile is mapped to a point of the physical space by the function 'map-lattice-to-coordinate-space', which is described in the next section.</p>
<div class="image">
<img src="tile.png" alt="tile.png"/>
<div class="caption">
Example of a two-dimensional tile of a single process. Points in the cyan region (halo) are shared among neighbouring processes to ensure stability of the evolution of the wave function inside the orange region.</div></div>
 <h2>Mapping coordinates of the lattice to the physical space </h2>
<p>A point \((i,j)\) of the tile is mapped to a point in the physical space, where the wave function is defined, as </p><p class="formulaDsp">
\begin{equation} \begin{aligned} x &amp;= \Delta x \left(i - \frac{N_x-1}{2} + st_x\right) \\ y &amp;= \Delta y \left(j - \frac{N_y-1}{2} + st_y\right) \end{aligned} \end{equation}
</p>
<p> for cartesian coordinates, where \(\Delta x = L_x / N_x\), \(\Delta y = L_y / N_y\) and \(st_x\) and \(st_y\) are respectively start-x and start-y. On the other hand, cylindrical coordinates are mapped with a different map. In this case when the user define \(N_r\) points in the lattice along the radial coordinate, another point is added so that it has a negative radial value (this point is needed to ensure the stability of the evolution). Then, the map is </p><p class="formulaDsp">
\begin{equation} \begin{aligned} r &amp;= \Delta r \left(i - \frac{1}{2} + st_r\right) \\ z &amp;= \Delta z \left(j - \frac{N_z-1}{2} + st_z\right) \end{aligned} \end{equation}
</p>
<p> where \(\Delta_r = L_r / (N_r + \frac{1}{2})\) and \(\Delta z = L_z / N_z\).</p>
<h1>Evolution operator </h1>
<p>The evolution operator is calculated using the Trotter-Suzuki approximation. Given an <a class="el" href="classHamiltonian.html" title="This class defines the Hamiltonian of a single component system. ">Hamiltonian</a> as a sum of hermitian operators, for instance \(H = H_1 + H_2 + H_3\), the evolution is approximated as </p><p class="formulaDsp">
\begin{equation} e^{-i\Delta tH} = e^{-i\frac{\Delta t}{2} H_1} e^{-i\frac{\Delta t}{2} H_2} e^{-i\frac{\Delta t}{2} H_3} e^{-i\frac{\Delta t}{2} H_3} e^{-i\frac{\Delta t}{2} H_2} e^{-i\frac{\Delta t}{2} H_1}. \end{equation}
</p>
<p> Since the wavefunction is discretized in the space coordinate representation, to avoid Fourier transformation, the derivatives are approximated using finite differences.</p>
<h2>Kinetic operators </h2>
<p>In cartesian coordinates, the kinetic term is \(K = -\frac{1}{2m} \left( \partial_x^2 + \partial_y^2 \right)\). The discrete form of the second derivative is </p><p class="formulaDsp">
\begin{equation} \partial_x^2 \psi(x) = \frac{\psi(x + \Delta x) - 2 \psi(x) + \psi(x - \Delta x)}{\Delta x^2} \end{equation}
</p>
<p> It is useful to express the above equation in a matrix form. The wave function can be vectorized as it is discrete, hence the partial derivative is the matrix </p><p class="formulaDsp">
\begin{equation} \begin{aligned} \frac{1}{\Delta x^2} \left(\begin{array}{ccc} -2 &amp; 1 &amp; 0 \\ 1 &amp; -2 &amp; 1 \\ 0 &amp; 1 &amp; -2 \end{array} \right) =&amp; \frac{1}{\Delta x^2} \left(\begin{array}{ccc} 0 &amp; 1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{array} \right) + \frac{1}{\Delta x^2} \left(\begin{array}{ccc} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 0 \end{array} \right)\\ &amp;- \frac{2}{\Delta x^2} \left(\begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right). \end{aligned} \end{equation}
</p>
<p> On the right-hand side of the above equation the last matrix is the identity and in the approximation of Trotter-Suzuki it gives only a global shift of the wave function, which can be ignored. The other two matrices are in the diagonal block form and can be easily exponentiated. Indeed, for the real time evolution: </p><p class="formulaDsp">
\begin{equation} \exp\left[i\frac{\Delta t}{4m \Delta x^2} \left(\begin{array}{cc} 0 &amp; 1 \\ 1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cos\beta &amp; i\sin\beta \\ i\sin\beta &amp; \cos\beta \end{array} \right). \end{equation}
</p>
<p> While, for imaginary time evolution: </p><p class="formulaDsp">
\begin{equation} \exp\left[\frac{\Delta t}{4m \Delta x^2} \left(\begin{array}{cc} 0 &amp; 1 \\ 1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cosh\beta &amp; \sinh\beta \\ \sinh\beta &amp; \cosh\beta \end{array} \right), \end{equation}
</p>
<p> with \(\beta = \frac{\Delta t}{4m \Delta x^2}\).</p>
<p>In cylindrical coordinates, the kinetic operator has an additional term, \(K = -\frac{1}{2m} \left( \partial_r^2 + \frac{1}{r} \partial_r+ \partial_z^2 \right)\). The first derivative is discretized as </p><p class="formulaDsp">
\begin{equation} \frac{1}{r}\partial_r \psi(r) = \frac{\psi(r + \Delta r) - \psi(r - \Delta r)}{2 r \Delta r}, \end{equation}
</p>
<p> and in matrix form </p><p class="formulaDsp">
\begin{equation} \frac{1}{2 \Delta r} \left(\begin{array}{ccc} 0 &amp; \frac{1}{r_0} &amp; 0 \\ -\frac{1}{r_1} &amp; 0 &amp; \frac{1}{r_1} \\ 0 &amp; -\frac{1}{r_2} &amp; 0 \end{array} \right) = \frac{1}{2 \Delta r} \left(\begin{array}{ccc} 0 &amp; \frac{1}{r_0} &amp; 0 \\ -\frac{1}{r_1} &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{array} \right) + \frac{1}{2 \Delta r} \left(\begin{array}{ccc} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; \frac{1}{r_1} \\ 0 &amp; -\frac{1}{r_2} &amp; 0 \end{array} \right). \end{equation}
</p>
<p> The exponentiation of a block is, for real-time evolution: </p><p class="formulaDsp">
\begin{equation} \exp\left[i\frac{\Delta t}{8m \Delta r} \left(\begin{array}{cc} 0 &amp; \frac{1}{r_1} \\ -\frac{1}{r_2} &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cosh\beta &amp; i\alpha\sinh\beta \\ -i\frac{1}{\alpha}\sinh\beta &amp; \cosh\beta \end{array} \right). \end{equation}
</p>
<p> While, for imaginary time evolution: </p><p class="formulaDsp">
\begin{equation} \exp\left[\frac{\Delta t}{8m \Delta r} \left(\begin{array}{cc} 0 &amp; \frac{1}{r_1} \\ -\frac{1}{r_2} &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cos\beta &amp; \alpha\sin\beta \\ -\frac{1}{\alpha}\sin\beta &amp; \cos\beta \end{array} \right). \end{equation}
</p>
<p> with \(\beta = \frac{\Delta t}{8m \Delta r \sqrt{r_1r_2}}\), \(\alpha = \sqrt{\frac{r_2}{r_1}}\) and \(r_1, r_2 &gt; 0\). However, the block matrix that contains \(1/r_0\) has a different exponentiation, since \(r_0 &lt; 0 \).</p>
<p>In particular \(r_0 = - r_1\) and for the real-time evolution, the block is of the form </p><p class="formulaDsp">
\begin{equation} \exp\left[i\frac{\Delta t}{8m r_1\Delta r} \left(\begin{array}{cc} 0 &amp; -1 \\ -1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cos\beta &amp; i\sin\beta \\ i\sin\beta &amp; \cos\beta \end{array} \right) \end{equation}
</p>
<p> for imaginary-time evolution </p><p class="formulaDsp">
\begin{equation} \exp\left[\frac{\Delta t}{8m r_1\Delta r} \left(\begin{array}{cc} 0 &amp; -1 \\ -1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cosh\beta &amp; \sinh\beta \\ \sinh\beta &amp; \cosh\beta \end{array} \right) \end{equation}
</p>
<p> with \(\beta = -\frac{\Delta t}{8m r_1 \Delta r}\).</p>
<h2>External potential </h2>
<p>An external potential dependent on the coordinate space is trivial to calculate. For the discretization that we use, such external potential is approximated by a diagonal matrix. For real time evolution </p><p class="formulaDsp">
\begin{equation} \begin{aligned} \exp[-i\Delta t V] &amp;= \exp\left[-i\Delta t \left(\begin{array}{ccc} V(x_0,y_0) &amp; 0 &amp; 0 \\ 0 &amp; V(x_1,y_0) &amp; 0 \\ 0 &amp; 0 &amp; V(x_2,y_0) \end{array} \right)\right] \\ &amp;= \left(\begin{array}{ccc} e^{-i\Delta t V(x_0,y_0)} &amp; 0 &amp; 0 \\ 0 &amp; e^{-i\Delta t V(x_1,y_0)} &amp; 0 \\ 0 &amp; 0 &amp; e^{-i\Delta t V(x_2,y_0)} \end{array} \right) \end{aligned} \end{equation}
</p>
<p> and for imaginary time evolution </p><p class="formulaDsp">
\begin{equation} \begin{aligned} \exp[-\Delta t V] &amp;= \exp\left[-\Delta t \left(\begin{array}{ccc} V(x_0,y_0) &amp; 0 &amp; 0 \\ 0 &amp; V(x_1,y_0) &amp; 0 \\ 0 &amp; 0 &amp; V(x_2,y_0) \end{array} \right)\right] \\ &amp;= \left(\begin{array}{ccc} e^{-\Delta t V(x_0,y_0)} &amp; 0 &amp; 0 \\ 0 &amp; e^{-\Delta t V(x_1,y_0)} &amp; 0 \\ 0 &amp; 0 &amp; e^{-\Delta t V(x_2,y_0)} \end{array} \right) \end{aligned} \end{equation}
</p>
<h2>Self interaction term </h2>
<p>The self interaction term of the wave function, \(g|\psi(x,y)|^2\), depends on the coordinate space, hence its discrete form is a diagonal matrix, as in the case of the external potential. In addition, the Lee-Huang-Yang term, \(g_{LHY}|\psi(x,y)|^3\), is implemented in the same way.</p>
<h2>Angular momentum </h2>
<p>For cartesian coordinates the <a class="el" href="classHamiltonian.html" title="This class defines the Hamiltonian of a single component system. ">Hamiltonian</a> containing the angular momentum operator is </p><p class="formulaDsp">
\begin{equation} -i \omega\left( x\partial_y - y\partial_x \right). \end{equation}
</p>
<p> For the trotter-suzuki approximation, the exponentiation is done separately for the two terms:</p>
<ul>
<li><p class="startli">First term, real-time evolution, \(\beta = \frac{\Delta t \omega x}{2\Delta y}\)</p>
<p class="formulaDsp">
\begin{equation} \exp[-\Delta t \omega x\partial_y] = \exp\left[-\beta \left(\begin{array}{cc} 0 &amp; 1 \\ -1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cos\beta &amp; -\sin\beta \\ \sin\beta &amp; \cos\beta \end{array} \right) \end{equation}
</p>
</li>
<li>First term, imaginary-time evolution, \(\beta = \frac{\Delta t \omega x}{2\Delta y}\) <p class="formulaDsp">
\begin{equation} \exp[i\Delta t \omega x\partial_y] = \exp\left[-\beta \left(\begin{array}{cc} 0 &amp; 1 \\ -1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cosh\beta &amp; i\sinh\beta \\ -i\sinh\beta &amp; \cosh\beta \end{array} \right) \end{equation}
</p>
</li>
<li>Second term, real-time evolution, \(\beta = \frac{\Delta t \omega y}{2\Delta x}\) <p class="formulaDsp">
\begin{equation} \exp[\Delta t \omega y\partial_x] = \exp\left[-\beta \left(\begin{array}{cc} 0 &amp; 1 \\ -1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cos\beta &amp; \sin\beta \\ -\sin\beta &amp; \cos\beta \end{array} \right) \end{equation}
</p>
</li>
<li>Second term, imaginary-time evolution, \(\beta = \frac{\Delta t \omega y}{2\Delta x}\) <p class="formulaDsp">
\begin{equation} \exp[-i\Delta t \omega y\partial_x] = \exp\left[-\beta \left(\begin{array}{cc} 0 &amp; 1 \\ -1 &amp; 0 \end{array} \right)\right] = \left(\begin{array}{cc} \cosh\beta &amp; -i\sinh\beta \\ i\sinh\beta &amp; \cosh\beta \end{array} \right) \end{equation}
</p>
 </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
